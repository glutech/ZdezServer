package cn.com.zdez.dao;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import cn.com.zdez.po.School;
import cn.com.zdez.po.Student;

public class SchoolDao {
	
	private SQLExecution sqlE = new SQLExecution();
	
	public String getSchoolNameById(int schoolId) {
		String schoolName = "";
		String sql = "select * from school where id=?";
		Object[] params = { schoolId };
		ResultSet rs = sqlE.execSqlWithRS(sql, params);
		try {
			while(rs.next()) {
				schoolName = rs.getString("name");
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return schoolName;
	}
	
	public List<School> getAll() {
		List<School> list = new ArrayList<School>();
		String sql = "select * from school";
		Object[] params = {};
		ResultSet rs = sqlE.execSqlWithRS(sql, params);
		try {
			while(rs.next()) {
				School s = new School();
				s.setId(rs.getInt("id"));
				s.setName(rs.getString("name"));
				s.setAddress(rs.getString("address"));
				list.add(s);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return list;
	}
	 
	public int getSchoolIdByStu(Student stu) {
		int i = 0;
		String sql = "select schoolId from department where id = any(select departmentId from major where id = any(select majorId from student where id = ?))";
		Object[] params = { stu.getId() };
		ResultSet rs = sqlE.execSqlWithRS(sql, params);
		try {
			while(rs.next()) {
				i = rs.getInt(1);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return i;
	}

}
